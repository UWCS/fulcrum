{% from "events/macros/pill.html" import pill %}

{% macro ordinal(day) %}
    {% set suffix = "th" %}
    {% if day not in [11,12,13] %}
        {% set suffix = {1:"st",2:"nd",3:"rd"}.get(day % 10, suffix) %}
    {% endif %}
    {{ day }}{{ suffix }}
{% endmacro %}

{% macro list(events) %}
    {% for year in events %}
        {% if year.terms|length > 1 %}
            <h1>{{ year.year }}</h1>
        {% endif %}
        {% for term in year.terms %}
            {% if term.weeks|length > 1 %}
                <h2>Term {{ term.term }}</h2>
            {% endif %}
            {% for week in term.weeks %}
                <h3>
                    <span class="fw-semibold">Week {{ week.week }}</span>
                    <span class="fs-5 text-muted">(w/c {{ ordinal(week.start_date.day) }} {{ week.start_date.strftime('%b') }})</span>
                </h3>
                {% for day in week.days %}
                    <h4 class="text-muted">{{ day.day }}</h4>
                    {% for event in day.events %}
                        {{ pill(event, False) }}
                    {% endfor %}
                {% endfor %}
            {% endfor %}
        {% endfor %}
    {% else %}
        <p>No events found :(</p>
    {% endfor %}
{% endmacro %}